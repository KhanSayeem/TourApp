@model TourismApp.Models.ViewModels.TourPackageEditVM
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    ViewData["Title"] = "Edit Tour Package";
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="fas fa-edit me-2"></i>Edit Tour Package</h2>
    <a asp-action="MyPackages" class="btn btn-outline-secondary">
        <i class="fas fa-arrow-left"></i> Back to My Packages
    </a>
</div>

<form asp-action="Edit" method="post">
  @Html.AntiForgeryToken()
  <input type="hidden" asp-for="Id" />
  <input type="hidden" asp-for="AgencyProfileId" />
  <div asp-validation-summary="All" class="text-danger"></div>

  <div class="mb-3"><label asp-for="Title" class="form-label"></label><input asp-for="Title" class="form-control"/><span asp-validation-for="Title" class="text-danger"></span></div>
  <div class="mb-3"><label asp-for="Description" class="form-label"></label><textarea asp-for="Description" class="form-control"></textarea><span asp-validation-for="Description" class="text-danger"></span></div>
  <div class="mb-3"><label asp-for="DurationDays" class="form-label"></label><input asp-for="DurationDays" class="form-control" type="number"/><span asp-validation-for="DurationDays" class="text-danger"></span></div>
  <div class="mb-3"><label asp-for="Price" class="form-label"></label><input asp-for="Price" class="form-control" type="number" step="0.01"/><span asp-validation-for="Price" class="text-danger"></span></div>
  <div class="mb-3"><label asp-for="GroupSizeLimit" class="form-label"></label><input asp-for="GroupSizeLimit" class="form-control" type="number"/><span asp-validation-for="GroupSizeLimit" class="text-danger"></span></div>
  <div class="mb-3"><label asp-for="ImagePath" class="form-label"></label><input asp-for="ImagePath" class="form-control"/></div>

  <h4 class="mt-4">Existing Dates</h4>
  @if (!Model.ExistingDates.Any())
  {
    <div class="alert alert-info">No dates yet.</div>
  }
  else
  {
    <table class="table table-sm align-middle">
      <thead><tr><th>Date</th><th>Capacity</th><th>Remove</th></tr></thead>
      <tbody>
      @for (int i = 0; i < Model.ExistingDates.Count; i++)
      {
        <tr>
          <td>
            <input type="hidden" asp-for="ExistingDates[@i].Id" />
            <input asp-for="ExistingDates[@i].Date" class="form-control" type="date" />
          </td>
          <td><input asp-for="ExistingDates[@i].Capacity" class="form-control" type="number" /></td>
          <td class="text-center"><input asp-for="ExistingDates[@i].Remove" class="form-check-input" type="checkbox" /></td>
        </tr>
      }
      </tbody>
    </table>
  }

  <h4 class="mt-4">Add New Dates</h4>
  <table class="table table-sm">
    <thead><tr><th>Date</th><th>Capacity</th></tr></thead>
    <tbody>
    @for (int i = 0; i < Model.NewDates.Count; i++)
    {
      <tr>
        <td><input asp-for="NewDates[@i].Date" class="form-control" type="date" /></td>
        <td><input asp-for="NewDates[@i].Capacity" class="form-control" type="number" /></td>
      </tr>
    }
    </tbody>
  </table>

  <button class="btn btn-primary">Save</button>
</form>

@section Scripts { <partial name="_ValidationScriptsPartial" /> }
